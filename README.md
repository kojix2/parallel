# Parallel

[![test](https://github.com/kojix2/parallel/actions/workflows/test.yml/badge.svg)](https://github.com/kojix2/parallel/actions/workflows/test.yml)

Crystal library for parallel processing using Fiber::ExecutionContext.

## Requirements

- Crystal 1.6.0+
- Compile flags: `-Dpreview_mt -Dexecution_context`

## Installation

Add to `shard.yml`:

```yaml
dependencies:
  parallel:
    github: kojix2/parallel
```

Run `shards install`

## Usage

```crystal
require "parallel"

# Parallel map
[1, 2, 3, 4].par_map { |x| x * 2 }
# => [2, 4, 6, 8]

# Parallel sum
(1..100).par_sum { |x| x }
# => 5050

# Parallel each
[1, 2, 3, 4].par_each { |x| puts x }

# Custom ExecutionContext
context = Fiber::ExecutionContext::MultiThreaded.new("workers", 8)
[1, 2, 3, 4].par_map(context) { |x| x * 2 }
```

### Compilation

```bash
crystal build -Dpreview_mt -Dexecution_context your_app.cr
crystal spec -Dpreview_mt -Dexecution_context
```

## Methods

- par_map(execution_context = nil, &block)

  - Applies block to each element in parallel, returns array of results.

- par_sum(execution_context = nil, &block)

  - Applies block to each element in parallel, returns sum of results.

- par_each(execution_context = nil, &block)
  - Applies block to each element in parallel for side effects.

## Notes

- Works with any Enumerable (Array, Range, Set, Hash, etc.)
- Indexable types (Array, Slice) preserve order
- Exceptions are propagated from parallel tasks
- Uses global ExecutionContext by default for performance
- Thread safety is your responsibility when accessing shared resources

## Compilation

```bash
crystal build src/your_app.cr -Dpreview_mt -Dexecution_context
crystal spec -Dpreview_mt -Dexecution_context
```

## License

MIT

This library contains code generated by AI.
