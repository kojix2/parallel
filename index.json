{"repository_name":"parallel","body":"# Parallel\n\n[![test](https://github.com/kojix2/parallel/actions/workflows/test.yml/badge.svg)](https://github.com/kojix2/parallel/actions/workflows/test.yml)\n[![Lines of Code](https://img.shields.io/endpoint?url=https%3A%2F%2Ftokei.kojix2.net%2Fbadge%2Fgithub%2Fkojix2%2Fparallel%2Flines)](https://tokei.kojix2.net/github/kojix2/parallel)\n\nCrystal library for parallel processing using Fiber::ExecutionContext.\n\n## Requirements\n\n- Crystal 1.6.0+\n- Compile flags: `-Dpreview_mt -Dexecution_context`\n\n## Installation\n\nAdd to `shard.yml`:\n\n```yaml\ndependencies:\n  parallel:\n    github: kojix2/parallel\n```\n\nRun `shards install`\n\n## Usage\n\n```crystal\nrequire \"parallel\"\n\n# Parallel map\n[1, 2, 3, 4].par_map { |x| x * 2 }\n# => [2, 4, 6, 8]\n\n# Parallel each\n[1, 2, 3, 4].par_each { |x| puts x }\n\n# Custom ExecutionContext\ncontext = Fiber::ExecutionContext::MultiThreaded.new(\"workers\", 8)\n[1, 2, 3, 4].par_map(context) { |x| x * 2 }\n```\n\n### Compilation\n\n```bash\ncrystal build -Dpreview_mt -Dexecution_context your_app.cr\ncrystal spec -Dpreview_mt -Dexecution_context\n```\n\n## Methods\n\n- par_map(execution_context = nil, &block)\n\n  - Applies block to each element in parallel, returns array of results.\n\n- par_each(execution_context = nil, &block)\n  - Applies block to each element in parallel for side effects.\n\n## Notes\n\n- Works with any Enumerable (Array, Range, Set, Hash, etc.)\n- Indexable types (Array, Slice) preserve order\n- Exceptions are propagated from parallel tasks\n- Uses global ExecutionContext by default for performance\n- Thread safety is your responsibility when accessing shared resources\n\n## Compilation\n\n```bash\ncrystal build src/your_app.cr -Dpreview_mt -Dexecution_context\ncrystal spec -Dpreview_mt -Dexecution_context\n```\n\n## License\n\nMIT\n\nThis library contains code generated by AI.\n","program":{"html_id":"parallel/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"locations":[],"repository_name":"parallel","program":true,"enum":false,"alias":false,"const":false,"types":[{"html_id":"parallel/Enumerable","path":"Enumerable.html","kind":"module","full_name":"Enumerable(T)","name":"Enumerable","abstract":false,"locations":[{"filename":"src/parallel.cr","line_number":23,"url":"https://github.com/kojix2/parallel/blob/d200f42329937b655146a395d6bd45463be8ff05/src/parallel.cr#L23"}],"repository_name":"parallel","program":false,"enum":false,"alias":false,"const":false,"including_types":[{"html_id":"parallel/Indexable","kind":"module","full_name":"Indexable(T)","name":"Indexable"}],"doc":"Extension for Enumerable types (Array, Hash, Set, Range, etc.)","summary":"<p>Extension for Enumerable types (Array, Hash, Set, Range, etc.)</p>","instance_methods":[{"html_id":"par_each(execution_context:Fiber::ExecutionContext::MultiThreaded|Nil=nil,&block:T->_)-instance-method","name":"par_each","doc":"Parallel each operation\nApplies the given block to each element in parallel (no return value)\n\n```\n[1, 2, 3].par_each { |x| puts x }\n```","summary":"<p>Parallel each operation Applies the given block to each element in parallel (no return value)</p>","abstract":false,"args":[{"name":"execution_context","default_value":"nil","external_name":"execution_context","restriction":"Fiber::ExecutionContext::MultiThreaded | ::Nil"}],"args_string":"(execution_context : Fiber::ExecutionContext::MultiThreaded | Nil = nil, &block : T -> _)","args_html":"(execution_context : Fiber::ExecutionContext::MultiThreaded | Nil = <span class=\"n\">nil</span>, &block : T -> _)","location":{"filename":"src/parallel.cr","line_number":66,"url":"https://github.com/kojix2/parallel/blob/d200f42329937b655146a395d6bd45463be8ff05/src/parallel.cr#L66"},"def":{"name":"par_each","args":[{"name":"execution_context","default_value":"nil","external_name":"execution_context","restriction":"Fiber::ExecutionContext::MultiThreaded | ::Nil"}],"yields":1,"block_arity":1,"block_arg":{"name":"block","external_name":"block","restriction":"(T -> _)"},"visibility":"Public","body":"context = execution_context || Parallel::PARALLEL_CONTEXT\nitems = self.to_a\nerrors = Channel(Exception).new\ncompleted = Channel(Nil).new\n\nitems.each do |item|\n  context.spawn do\n    begin\n      block.call(item)\n      completed.send(nil)\n    rescue ex\n      errors.send(ex)\n    end\n  end\nend\n\nitems.size.times do\n  select\n  when error = errors.receive\n    raise(error)\n  when completed.receive\n  end\nend\n"},"external_var":false},{"html_id":"par_map(execution_context:Fiber::ExecutionContext::MultiThreaded|Nil=nil,&block:T->U)forallU-instance-method","name":"par_map","doc":"Parallel map operation\nApplies the given block to each element in parallel and returns an array of results\n\n```\n[1, 2, 3, 4].par_map { |x| x * 2 } # => [2, 4, 6, 8]\n```","summary":"<p>Parallel map operation Applies the given block to each element in parallel and returns an array of results</p>","abstract":false,"args":[{"name":"execution_context","default_value":"nil","external_name":"execution_context","restriction":"Fiber::ExecutionContext::MultiThreaded | ::Nil"}],"args_string":"(execution_context : Fiber::ExecutionContext::MultiThreaded | Nil = nil, &block : T -> U) forall U","args_html":"(execution_context : Fiber::ExecutionContext::MultiThreaded | Nil = <span class=\"n\">nil</span>, &block : T -> U) forall U","location":{"filename":"src/parallel.cr","line_number":30,"url":"https://github.com/kojix2/parallel/blob/d200f42329937b655146a395d6bd45463be8ff05/src/parallel.cr#L30"},"def":{"name":"par_map","args":[{"name":"execution_context","default_value":"nil","external_name":"execution_context","restriction":"Fiber::ExecutionContext::MultiThreaded | ::Nil"}],"yields":1,"block_arity":1,"block_arg":{"name":"block","external_name":"block","restriction":"(T -> U)"},"visibility":"Public","body":"context = execution_context || Parallel::PARALLEL_CONTEXT\nitems = self.to_a\nresults = Channel(Tuple(Int32, U) | Exception).new\n\nitems.each_with_index do |item, idx|\n  context.spawn do\n    begin\n      result = block.call(item)\n      results.send({idx, result})\n    rescue ex\n      results.send(ex)\n    end\n  end\nend\n\ntemp_results = Array(Tuple(Int32, U)).new\nitems.size.times do\n  case result = results.receive\n  when Tuple(Int32, U)\n    temp_results << result\n  when Exception\n    raise(result)\n  end\nend\n\n\ntemp_results.sort_by(&.[](0)).map(&.[](1))\n"},"external_var":false}]},{"html_id":"parallel/Indexable","path":"Indexable.html","kind":"module","full_name":"Indexable(T)","name":"Indexable","abstract":false,"ancestors":[{"html_id":"parallel/Enumerable","kind":"module","full_name":"Enumerable","name":"Enumerable"},{"html_id":"parallel/Iterable","kind":"module","full_name":"Iterable","name":"Iterable"}],"locations":[{"filename":"src/parallel.cr","line_number":95,"url":"https://github.com/kojix2/parallel/blob/d200f42329937b655146a395d6bd45463be8ff05/src/parallel.cr#L95"}],"repository_name":"parallel","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"parallel/Enumerable","kind":"module","full_name":"Enumerable","name":"Enumerable"},{"html_id":"parallel/Iterable","kind":"module","full_name":"Iterable","name":"Iterable"}],"doc":"Optimized extension for Indexable types (Array, Slice, etc.)","summary":"<p>Optimized extension for Indexable types (Array, Slice, etc.)</p>","instance_methods":[{"html_id":"par_each(execution_context:Fiber::ExecutionContext::MultiThreaded|Nil=nil,&block:T->_)-instance-method","name":"par_each","doc":"Optimized parallel each for indexable collections","summary":"<p>Optimized parallel each for indexable collections</p>","abstract":false,"args":[{"name":"execution_context","default_value":"nil","external_name":"execution_context","restriction":"Fiber::ExecutionContext::MultiThreaded | ::Nil"}],"args_string":"(execution_context : Fiber::ExecutionContext::MultiThreaded | Nil = nil, &block : T -> _)","args_html":"(execution_context : Fiber::ExecutionContext::MultiThreaded | Nil = <span class=\"n\">nil</span>, &block : T -> _)","location":{"filename":"src/parallel.cr","line_number":128,"url":"https://github.com/kojix2/parallel/blob/d200f42329937b655146a395d6bd45463be8ff05/src/parallel.cr#L128"},"def":{"name":"par_each","args":[{"name":"execution_context","default_value":"nil","external_name":"execution_context","restriction":"Fiber::ExecutionContext::MultiThreaded | ::Nil"}],"yields":1,"block_arity":1,"block_arg":{"name":"block","external_name":"block","restriction":"(T -> _)"},"visibility":"Public","body":"context = execution_context || Parallel::PARALLEL_CONTEXT\nerrors = Channel(Exception).new\ncompleted = Channel(Nil).new\n\n(0...size).each do |index|\n  context.spawn do\n    begin\n      block.call(unsafe_fetch(index))\n      completed.send(nil)\n    rescue ex\n      errors.send(ex)\n    end\n  end\nend\n\nsize.times do\n  select\n  when error = errors.receive\n    raise(error)\n  when completed.receive\n  end\nend\n"},"external_var":false},{"html_id":"par_map(execution_context:Fiber::ExecutionContext::MultiThreaded|Nil=nil,&block:T->U)forallU-instance-method","name":"par_map","doc":"Optimized parallel map for indexable collections\nUses unsafe_fetch for better performance and guarantees order preservation","summary":"<p>Optimized parallel map for indexable collections Uses unsafe_fetch for better performance and guarantees order preservation</p>","abstract":false,"args":[{"name":"execution_context","default_value":"nil","external_name":"execution_context","restriction":"Fiber::ExecutionContext::MultiThreaded | ::Nil"}],"args_string":"(execution_context : Fiber::ExecutionContext::MultiThreaded | Nil = nil, &block : T -> U) forall U","args_html":"(execution_context : Fiber::ExecutionContext::MultiThreaded | Nil = <span class=\"n\">nil</span>, &block : T -> U) forall U","location":{"filename":"src/parallel.cr","line_number":98,"url":"https://github.com/kojix2/parallel/blob/d200f42329937b655146a395d6bd45463be8ff05/src/parallel.cr#L98"},"def":{"name":"par_map","args":[{"name":"execution_context","default_value":"nil","external_name":"execution_context","restriction":"Fiber::ExecutionContext::MultiThreaded | ::Nil"}],"yields":1,"block_arity":1,"block_arg":{"name":"block","external_name":"block","restriction":"(T -> U)"},"visibility":"Public","body":"context = execution_context || Parallel::PARALLEL_CONTEXT\nresults = Channel(Tuple(Int32, U) | Exception).new\ntemp_results = Array(Tuple(Int32, U)).new\n\n(0...size).each do |index|\n  context.spawn do\n    begin\n      result = block.call(unsafe_fetch(index))\n      results.send({index, result})\n    rescue ex\n      results.send(ex)\n    end\n  end\nend\n\nsize.times do\n  case result = results.receive\n  when Tuple(Int32, U)\n    temp_results << result\n  when Exception\n    raise(result)\n  end\nend\n\n\ntemp_results.sort_by(&.[](0)).map(&.[](1))\n"},"external_var":false}]},{"html_id":"parallel/Parallel","path":"Parallel.html","kind":"module","full_name":"Parallel","name":"Parallel","abstract":false,"locations":[{"filename":"src/parallel.cr","line_number":11,"url":"https://github.com/kojix2/parallel/blob/d200f42329937b655146a395d6bd45463be8ff05/src/parallel.cr#L11"}],"repository_name":"parallel","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"PARALLEL_CONTEXT","name":"PARALLEL_CONTEXT","value":"Fiber::ExecutionContext::MultiThreaded.new(\"parallel-workers\", Fiber::ExecutionContext.default_workers_count)","doc":"Global ExecutionContext for parallel processing\nReusing a single context is recommended for performance","summary":"<p>Global ExecutionContext for parallel processing Reusing a single context is recommended for performance</p>"},{"id":"VERSION","name":"VERSION","value":"{{ (`shards version /home/runner/work/parallel/parallel/src`).chomp.stringify }}"}],"doc":"Parallel processing library for Crystal using Fiber::ExecutionContext\n\nThis library extends Enumerable and Indexable with parallel processing methods.\nIt requires Crystal 1.6.0+ and the following flags:\n-Dpreview_mt -Dexecution_context\n\nExample:\n```\n[1, 2, 3, 4].par_map { |x| x * 2 } # => [2, 4, 6, 8]\n```","summary":"<p>Parallel processing library for Crystal using Fiber::ExecutionContext</p>"}]}}